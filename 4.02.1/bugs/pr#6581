PR#6581: Some bugs in generative functors
(Jacques Garrigue, report by Mark Shinwell)