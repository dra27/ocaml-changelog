Set and Map: more efficient implementation of "filter" and "partition"